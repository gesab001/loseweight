<html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>


<body>

<h1>NEW DROPBOX ACCESS TOKEN</h1>
<div style="word-wrap: break-word;">
<h2 id="access_token"></h2>
</div>
<form action="./cgi-bin/updateAccessToken.py">

  <input id="access_tokenInput" name="access_tokenInput" type="text" value=""/>
  <input type="submit" value="submit"/>
</form>
</body>

<script>



function loadData(data){
    console.log(JSON.stringify(data["access_token"]));
	var access_token = JSON.stringify(data["access_token"]);
	console.log("original access_token: " + access_token);
	var ciphertext = CryptoJS.AES.encrypt(access_token, 'gesab001Bdgqviid1980!loseweight');
	document.getElementById("access_tokenInput").value = ciphertext;
	console.log("encrypted access_token: " + ciphertext);
	//alert(ciphertext);
	document.getElementById("access_token").innerHTML = ciphertext;
	var bytes = CryptoJS.AES.decrypt(ciphertext.toString(), 'secret');
	var decrypted_access_token = bytes.toString(CryptoJS.enc.Utf8);
	console.log("decrypted_access_token:" + decrypted_access_token);	
}

function fetchData(filename){
	
fetch(filename)
  .then((response) => response.json())
  .then(loadData);
  
}
fetchData("uncryptedAccessToken.json");
</script>
</html>